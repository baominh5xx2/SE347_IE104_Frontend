<div class="promotions-page">
  <div class="header-section">
    <div class="container mx-auto px-6 py-8">
      <h1 class="page-title">Khuy·∫øn m√£i</h1>
      <p class="page-subtitle">Kh√°m ph√° c√°c ch∆∞∆°ng tr√¨nh khuy·∫øn m√£i h·∫•p d·∫´n d√†nh cho b·∫°n</p>
    </div>
  </div>

  <div class="container mx-auto px-6 py-8">
    <div class="filters-section mb-8">
      <div class="filter-tabs">
        <button 
          class="filter-tab" 
          [class.active]="filterType === 'active'"
          (click)="changeFilter('active')">
          ƒêang √°p d·ª•ng
        </button>
        <button 
          class="filter-tab" 
          [class.active]="filterType === 'all'"
          (click)="changeFilter('all')">
          T·∫•t c·∫£
        </button>
        <button 
          class="filter-tab" 
          [class.active]="filterType === 'expired'"
          (click)="changeFilter('expired')">
          ƒê√£ h·∫øt h·∫°n
        </button>
      </div>
    </div>

    @if (isLoading) {
      <div class="loading-state">
        <div class="spinner"></div>
        <p>ƒêang t·∫£i danh s√°ch khuy·∫øn m√£i...</p>
      </div>
    } @else if (errorMessage) {
      <div class="error-state">
        <div class="error-icon">‚ö†</div>
        <h3>L·ªói khi t·∫£i danh s√°ch khuy·∫øn m√£i</h3>
        <p>{{ errorMessage }}</p>
        <button class="btn-retry" (click)="loadPromotions()">
          Th·ª≠ l·∫°i
        </button>
      </div>
    } @else if (filteredPromotions.length > 0) {
      <div class="promotions-grid">
        @for (promo of filteredPromotions; track promo.promotion_id) {
          <div class="promotion-card" [class.expired]="isExpired(promo)">
            <div class="promotion-header">
              <div class="discount-badge">
                {{ formatDiscount(promo) }}
              </div>
              @if (isExpired(promo)) {
                <div class="expired-badge">H·∫øt h·∫°n</div>
              }
            </div>

            <div class="promotion-body">
              <h3 class="promotion-name">{{ promo.name }}</h3>
              <p class="promotion-description">{{ promo.description }}</p>

              <div class="promotion-details">
                <div class="detail-item">
                  <span class="detail-label">M√£ khuy·∫øn m√£i:</span>
                  <div class="code-container">
                    <span class="promotion-code">{{ promo.promotion_id }}</span>
                    <button 
                      class="btn-copy" 
                      (click)="copyToClipboard(promo.promotion_id)"
                      [disabled]="isExpired(promo)">
                      Sao ch√©p
                    </button>
                  </div>
                </div>

                <div class="detail-item">
                  <span class="detail-label">Th·ªùi gian:</span>
                  <span class="detail-value">
                    {{ formatDate(promo.start_date) }} - {{ formatDate(promo.end_date) }}
                  </span>
                </div>

                <div class="detail-item">
                  <span class="detail-label">S·ªë l∆∞·ª£ng c√≤n l·∫°i:</span>
                  <span class="detail-value">
                    {{ getRemainingQuantity(promo) }} / {{ promo.quantity }}
                  </span>
                </div>
              </div>
            </div>

            <div class="promotion-footer">
              <div class="usage-info">
                ƒê√£ s·ª≠ d·ª•ng: {{ promo.used_count }} l∆∞·ª£t
              </div>
            </div>
          </div>
        }
      </div>
    } @else {
      <div class="empty-state">
        <div class="empty-icon">üéÅ</div>
        <h3>Kh√¥ng c√≥ khuy·∫øn m√£i n√†o</h3>
        <p>Hi·ªán t·∫°i kh√¥ng c√≥ ch∆∞∆°ng tr√¨nh khuy·∫øn m√£i ph√π h·ª£p v·ªõi b·ªô l·ªçc b·∫°n ƒë√£ ch·ªçn</p>
        <button class="btn-retry" (click)="changeFilter('all')">
          Xem t·∫•t c·∫£
        </button>
      </div>
    }
  </div>
</div>

