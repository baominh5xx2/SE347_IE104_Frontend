

<!-- Tour Details Section -->
<div *ngIf="isTourMode && tour && !isLoadingTour" class="container mx-auto px-6 py-6 bg-white">
  <!-- Tour Images -->
  <div class="flex gap-4 mb-6">
    <div class="w-1/2">
      <img [src]="tour.image_url || 'img/tour-default.jpg'" [alt]="tour.package_name" class="w-full h-96 object-cover rounded-lg">
    </div>
    <div class="flex-auto grid grid-cols-2 gap-4">
      <img [src]="tour.image_url || 'img/tour-default.jpg'" [alt]="tour.package_name" class="w-full h-44 object-cover rounded-lg">
      <img [src]="tour.image_url || 'img/tour-default.jpg'" [alt]="tour.package_name" class="w-full h-44 object-cover rounded-lg">
      <img [src]="tour.image_url || 'img/tour-default.jpg'" [alt]="tour.package_name" class="w-full h-44 object-cover rounded-lg">
      <img [src]="tour.image_url || 'img/tour-default.jpg'" [alt]="tour.package_name" class="w-full h-44 object-cover rounded-lg">
    </div>
  </div>

  <!-- Tour Header -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div>
      <h1 class="text-3xl font-bold mb-2">{{ tour.package_name }}</h1>
      <div class="flex items-center gap-4 text-gray-600 mb-4">
        <div class="flex items-center gap-2">
          <i class="fas fa-map-marker-alt"></i>
          <span>{{ tour.destination }}</span>
        </div>
        <div class="flex items-center gap-2" *ngIf="tour.rating">
          <i class="fas fa-star text-yellow-500"></i>
          <span>{{ tour.rating }}</span>
          <span class="text-sm" *ngIf="tour.reviews">({{ tour.reviews }} reviews)</span>
        </div>
      </div>
    </div>

    <div class="flex flex-col items-end justify-center">
      <div class="text-right mb-4">
        <p class="text-sm text-gray-600">Giá bắt đầu từ</p>
        <div class="flex items-center gap-3 justify-end">
          <p class="text-3xl font-bold text-orange-500">{{ formatPrice(getDiscountedPrice(tour)) }}</p>
          <p class="text-lg text-gray-500 line-through" *ngIf="tour.discount && tour.original_price">
            {{ formatPrice(tour.original_price) }}
          </p>
        </div>
        <p class="text-sm text-gray-600">cho {{ tour.duration_days }} ngày</p>
      </div>
      <button class="bg-orange-500 hover:bg-orange-600 text-white font-semibold rounded-lg py-3 px-8 transition" (click)="onBookTour()">
        Đặt tour ngay
      </button>
    </div>
  </div>

  <!-- Tour Info Cards -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
    <div class="bg-white rounded-lg shadow-md p-4">
      <div class="flex items-center gap-3">
        <i class="fas fa-clock text-2xl text-blue-500"></i>
        <div>
          <p class="text-sm text-gray-600">Thời lượng</p>
          <p class="font-semibold">{{ tour.duration_days }} ngày</p>
        </div>
      </div>
    </div>

    <div class="bg-white rounded-lg shadow-md p-4">
      <div class="flex items-center gap-3">
        <i class="fas fa-plane-departure text-2xl text-blue-500"></i>
        <div>
          <p class="text-sm text-gray-600">Xuất phát</p>
          <p class="font-semibold">{{ tour.departure_location }}</p>
        </div>
      </div>
    </div>

    <div class="bg-white rounded-lg shadow-md p-4" *ngIf="tour.start_date || tour.end_date">
      <div class="flex items-center gap-3">
        <i class="fas fa-calendar-alt text-2xl text-blue-500"></i>
        <div>
          <p class="text-sm text-gray-600">Ngày khởi hành</p>
          <p class="font-semibold">
            <span *ngIf="tour.start_date && tour.end_date">
              {{ formatDate(tour.start_date) }} - {{ formatDate(tour.end_date) }}
            </span>
            <span *ngIf="tour.start_date && !tour.end_date">
              {{ formatDate(tour.start_date) }}
            </span>
            <span *ngIf="!tour.start_date && tour.end_date">
              {{ formatDate(tour.end_date) }}
            </span>
          </p>
        </div>
      </div>
    </div>

    <div class="bg-white rounded-lg shadow-md p-4" *ngIf="tour.available_slots">
      <div class="flex items-center gap-3">
        <i class="fas fa-users text-2xl text-blue-500"></i>
        <div>
          <p class="text-sm text-gray-600">Còn chỗ</p>
          <p class="font-semibold">{{ tour.available_slots }} chỗ</p>
        </div>
      </div>
    </div>

    <div class="bg-white rounded-lg shadow-md p-4" *ngIf="tour.discount">
      <div class="flex items-center gap-3">
        <i class="fas fa-tag text-2xl text-red-500"></i>
        <div>
          <p class="text-sm text-gray-600">Giảm giá</p>
          <p class="font-semibold text-red-500">-{{ tour.discount }}%</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Tour Description -->
  <div class="bg-gray-50 rounded-lg p-6 mb-6">
    <h2 class="text-2xl font-bold mb-4">Giới thiệu</h2>
    <p class="text-gray-700 leading-relaxed">{{ tour.description || 'Không có mô tả' }}</p>
  </div>

  <!-- Tour Highlights -->
  <div class="bg-white rounded-lg shadow-md p-6 mb-6" *ngIf="tour.highlights && tour.highlights.length > 0">
    <h2 class="text-2xl font-bold mb-4">Điểm nổi bật</h2>
    <ul class="space-y-3">
      <li *ngFor="let highlight of tour.highlights" class="flex items-start gap-3">
        <i class="fas fa-check-circle text-green-500 mt-1"></i>
        <span class="text-gray-700">{{ highlight }}</span>
      </li>
    </ul>
  </div>

  <!-- Tour Includes -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div class="bg-white rounded-lg shadow-md p-6">
      <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
        <i class="fas fa-check text-green-500"></i>
        Bao gồm
      </h3>
      <ul class="space-y-2">
        <li *ngFor="let item of tour.includes" class="flex items-start gap-2">
          <i class="fas fa-chevron-right text-green-500 text-sm mt-1"></i>
          <span class="text-gray-700">{{ item }}</span>
        </li>
      </ul>
    </div>

    <div class="bg-white rounded-lg shadow-md p-6">
      <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
        <i class="fas fa-times text-red-500"></i>
        Không bao gồm
      </h3>
      <ul class="space-y-2">
        <li *ngFor="let item of tour.excludes" class="flex items-start gap-2">
          <i class="fas fa-chevron-right text-red-500 text-sm mt-1"></i>
          <span class="text-gray-700">{{ item }}</span>
        </li>
      </ul>
    </div>
  </div>

  <!-- Tour Itinerary -->
  <div class="bg-white rounded-lg shadow-md p-6 mb-6" *ngIf="tour.itinerary">
    <h2 class="text-2xl font-bold mb-6">Lịch trình chi tiết</h2>
    
    <div *ngIf="tour.itinerary.day1" class="mb-8 border-l-4 border-blue-500 pl-6">
      <h3 class="text-xl font-bold mb-3 text-blue-600">Ngày 1: {{ tour.itinerary.day1.title }}</h3>
      <div class="mb-4">
        <p class="text-sm text-gray-600 mb-1">
          <i class="fas fa-hotel mr-2"></i>Khách sạn: {{ tour.itinerary.day1.hotel }}
        </p>
        <p class="text-sm text-gray-600">
          <i class="fas fa-utensils mr-2"></i>Bữa ăn: {{ tour.itinerary.day1.meals }}
        </p>
      </div>
      <div class="space-y-4">
        <div *ngIf="tour.itinerary.day1.morning">
          <h4 class="font-semibold text-gray-800 mb-2">Buổi sáng</h4>
          <p class="text-gray-700 leading-relaxed">{{ tour.itinerary.day1.morning }}</p>
        </div>
        <div *ngIf="tour.itinerary.day1.afternoon">
          <h4 class="font-semibold text-gray-800 mb-2">Buổi chiều</h4>
          <p class="text-gray-700 leading-relaxed">{{ tour.itinerary.day1.afternoon }}</p>
        </div>
        <div *ngIf="tour.itinerary.day1.evening">
          <h4 class="font-semibold text-gray-800 mb-2">Buổi tối</h4>
          <p class="text-gray-700 leading-relaxed">{{ tour.itinerary.day1.evening }}</p>
        </div>
        <div *ngIf="tour.itinerary.day1.late_afternoon">
          <h4 class="font-semibold text-gray-800 mb-2">Chiều muộn</h4>
          <p class="text-gray-700 leading-relaxed">{{ tour.itinerary.day1.late_afternoon }}</p>
        </div>
      </div>
    </div>

    <div *ngIf="tour.itinerary.day2" class="mb-8 border-l-4 border-green-500 pl-6">
      <h3 class="text-xl font-bold mb-3 text-green-600">Ngày 2: {{ tour.itinerary.day2.title }}</h3>
      <div class="mb-4">
        <p class="text-sm text-gray-600 mb-1">
          <i class="fas fa-hotel mr-2"></i>Khách sạn: {{ tour.itinerary.day2.hotel }}
        </p>
        <p class="text-sm text-gray-600">
          <i class="fas fa-utensils mr-2"></i>Bữa ăn: {{ tour.itinerary.day2.meals }}
        </p>
      </div>
      <div class="space-y-4">
        <div *ngIf="tour.itinerary.day2.morning">
          <h4 class="font-semibold text-gray-800 mb-2">Buổi sáng</h4>
          <p class="text-gray-700 leading-relaxed">{{ tour.itinerary.day2.morning }}</p>
        </div>
        <div *ngIf="tour.itinerary.day2.afternoon">
          <h4 class="font-semibold text-gray-800 mb-2">Buổi chiều</h4>
          <p class="text-gray-700 leading-relaxed">{{ tour.itinerary.day2.afternoon }}</p>
        </div>
        <div *ngIf="tour.itinerary.day2.evening">
          <h4 class="font-semibold text-gray-800 mb-2">Buổi tối</h4>
          <p class="text-gray-700 leading-relaxed">{{ tour.itinerary.day2.evening }}</p>
        </div>
        <div *ngIf="tour.itinerary.day2.late_afternoon">
          <h4 class="font-semibold text-gray-800 mb-2">Chiều muộn</h4>
          <p class="text-gray-700 leading-relaxed">{{ tour.itinerary.day2.late_afternoon }}</p>
        </div>
      </div>
    </div>

    <div *ngIf="tour.itinerary.day3" class="mb-8 border-l-4 border-purple-500 pl-6">
      <h3 class="text-xl font-bold mb-3 text-purple-600">Ngày 3: {{ tour.itinerary.day3.title }}</h3>
      <div class="mb-4">
        <p class="text-sm text-gray-600 mb-1">
          <i class="fas fa-hotel mr-2"></i>Khách sạn: {{ tour.itinerary.day3.hotel }}
        </p>
        <p class="text-sm text-gray-600">
          <i class="fas fa-utensils mr-2"></i>Bữa ăn: {{ tour.itinerary.day3.meals }}
        </p>
      </div>
      <div class="space-y-4">
        <div *ngIf="tour.itinerary.day3.morning">
          <h4 class="font-semibold text-gray-800 mb-2">Buổi sáng</h4>
          <p class="text-gray-700 leading-relaxed">{{ tour.itinerary.day3.morning }}</p>
        </div>
        <div *ngIf="tour.itinerary.day3.afternoon">
          <h4 class="font-semibold text-gray-800 mb-2">Buổi chiều</h4>
          <p class="text-gray-700 leading-relaxed">{{ tour.itinerary.day3.afternoon }}</p>
        </div>
        <div *ngIf="tour.itinerary.day3.evening">
          <h4 class="font-semibold text-gray-800 mb-2">Buổi tối</h4>
          <p class="text-gray-700 leading-relaxed">{{ tour.itinerary.day3.evening }}</p>
        </div>
        <div *ngIf="tour.itinerary.day3.late_afternoon">
          <h4 class="font-semibold text-gray-800 mb-2">Chiều muộn</h4>
          <p class="text-gray-700 leading-relaxed">{{ tour.itinerary.day3.late_afternoon }}</p>
        </div>
      </div>
    </div>

    <div *ngIf="tour.itinerary.note" class="bg-yellow-50 border-l-4 border-yellow-500 p-4 mt-6">
      <h4 class="font-semibold text-gray-800 mb-2 flex items-center gap-2">
        <i class="fas fa-info-circle text-yellow-600"></i>
        Lưu ý
      </h4>
      <p class="text-gray-700">{{ tour.itinerary.note }}</p>
    </div>
  </div>

  <!-- Best Season -->
  <div class="bg-white rounded-lg shadow-md p-6 mb-6" *ngIf="tour.itinerary && tour.itinerary.best_season && tour.itinerary.best_season.length > 0">
    <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-calendar-check text-blue-500"></i>
      Thời điểm lý tưởng
    </h2>
    <ul class="space-y-2">
      <li *ngFor="let season of tour.itinerary?.best_season" class="flex items-start gap-3">
        <i class="fas fa-sun text-yellow-500 mt-1"></i>
        <span class="text-gray-700">{{ season }}</span>
      </li>
    </ul>
  </div>

  <!-- Photo Spots -->
  <div class="bg-white rounded-lg shadow-md p-6 mb-6" *ngIf="tour.itinerary && tour.itinerary.photo_spots && tour.itinerary.photo_spots.length > 0">
    <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-camera text-purple-500"></i>
      Địa điểm chụp ảnh đẹp
    </h2>
    <ul class="space-y-2">
      <li *ngFor="let spot of tour.itinerary?.photo_spots" class="flex items-start gap-3">
        <i class="fas fa-map-marker-alt text-purple-500 mt-1"></i>
        <span class="text-gray-700">{{ spot }}</span>
      </li>
    </ul>
  </div>

  <!-- Must Try Food -->
  <div class="bg-white rounded-lg shadow-md p-6 mb-6" *ngIf="tour.itinerary && tour.itinerary.must_try_food && tour.itinerary.must_try_food.length > 0">
    <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
      <i class="fas fa-utensils text-red-500"></i>
      Món ăn nên thử
    </h2>
    <ul class="space-y-2">
      <li *ngFor="let food of tour.itinerary?.must_try_food" class="flex items-start gap-3">
        <i class="fas fa-check-circle text-red-500 mt-1"></i>
        <span class="text-gray-700">{{ food }}</span>
      </li>
    </ul>
  </div>
</div>

<!-- Loading State -->
<div *ngIf="isTourMode && isLoadingTour" class="container mx-auto px-6 py-20 text-center">
  <div class="spinner mx-auto mb-4"></div>
  <p class="text-gray-600">Đang tải thông tin tour...</p>
</div>








